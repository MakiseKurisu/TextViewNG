<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
    "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="utf-8" lang="utf-8">
  <head>
    <title>Дополнительные программы для работы с FB2</title>
    <link rel="stylesheet" type="text/css" href="=.css">
  </head>
  <body>
    <div class="topmenu">
      <div class="logo"><img class="noborder" src="logo.png"></div>
      <!--<div class="mirror">
	<a class="menu small" href="http://haali.rt.ru/pocketpc/">Зеркало 1</a><br>
	<a class="menu small" href="http://haali.cs.msu.ru/pocketpc/">Зеркало 2</a>
      </div>-->
      <a class="menu sep" href="index.ru.html">Главная</a>
      <a class="menu sep" href="news.ru.html">Новости</a>
      <a class="menu sep" href="download.ru.html">Скачать</a>
      <a class="menu sep" href="screenshots.ru.html">Картинки</a>
      <a class="menu sep" href="docs.ru.html">Документация</a>
      <a class="menu sep" href="bugs.ru.html">Ошибки</a>
      <a class="menu sep" href="scripts.ru.html">FB Tools</a>
      <a class="menu sep" href="fb2.ru.html">FB2.0</a>
      <a class="menu" href="index.en.html">English page</a>
    </div>
    <div class="main">

<!-- vim: set syn=html : -->


   <h3>Дополнительные программы для работы с FB2</h3>
   <h4>FictionBook Tools</h4>
   <div class="center">
   <img src="img/explorer_xp.png"><br>
   Проводник в WinXP с установленными FB Tools
   </div>
   <br>
   FB Tools - пакет программ для облегчения работы с книгами в Windows. В него входят
   следующие компоненты:
   <ul>
    <li>Валидатор FB2 документов</li>
    <li>Редактор FB2 документов</li>
    <li>Провайдер информации об FB2 документах в Проводнике (позволяет просматривать
        авторов, название, жанр и прочую информацию прямо в проводнике, не открывая файл).</li>
   </ul>
   Все приложения интегрируются с проводником и добавляют команды в контекстное меню
   для папок (Validate FictionBook Documents) и файлов с расширением .fb2 (Edit,Validate).
   Редактор умеет изменять поля описания документа, экспортировать файлы HTML, вызывать
   <a href="http://www.gribuser.ru/freeware/cleartxt/index.shtml">Any2FB2</a> для импорта
   документов в других форматах. <strong>Внимание!</strong> Редактор игнорирует все XML
   комментарии и
   неизвестные элементы при чтении документов, так что будьте осторожны, при чтении файлов
   с комментариями и последующей записи, все комментарии пропадут.
   <br><br>
   <strong>FB Tools работают <em>только под Windows NT4/2K/XP</em></strong>.
   Для работы FBTools необходим <a href="http://www.microsoft.com/downloads/details.aspx?familyid=3144b72b-b4f2-46da-b4b6-c5d7485f2b42&displaylang=en">MSXML4</a>.<br>
   Скачать: <a href="files/FictionBook Tools v2.0 Setup.exe">FictionBook Tools v2.0 Setup.exe</a>
   ( 523k), <a href="files/FBE_Rel.tgz">Исходники</a> ( 345k).
   <br><hr noshade="1">
   <h4>Скрипты</h4>
   <ul>
  <li>Преобразование из простого текста в XML: рассчитано
  на книги из <a href="http://lib.ru/">библиотеки Максима Мошкова</a>, нормально понимает
  HTML вариант книг. На более сложном HTML скорее всего будет глючить. Для запуска нужен
  Perl под Windows и модуль Win32::GUI.<br>
  <a href="files/wtxt2xml.pl">wtxt2xml.pl</a> - с Win32 GUI,
  <a href="files/txt2xml.pl">txt2xml.pl</a> - запуск из командной строки, работает везде,
  <a href="files/T2X.pm">T2X.pm</a> - общий модуль преобразования.
  </li>
  <li>
  Преобразование из HTML в XML, хорошо разбирает HTML,
  который пишет M$ Office: <a href="files/html2xml.pl">html2xml.pl</a><br>
  <ul>
   <li>05/04/02 Извлекает некоторые свойства документа из заголовка, для этого нужен Win32::OLE и MSXML4</li>
   <li>19/02/02 Добавил распознавание сносок и починил какие-то мелочи.</li>
  </ul>
  </li>
  <li>XSL<br>
   <ul>
  <li>XSL для преобразования из FB1 в FB2: <a href="files/fb1tofb2.xsl">fb1tofb2.xsl</a>.</li>
  <li>XSL для преобразования из lite в FB1: <a href="files/lite2fb.xsl">lite2fb.xsl</a>.</li>
  </ul>
   Для применения этих XSL можно воспользоваться <a href="http://msdn.microsoft.com/XML/XMLDownloads/default.aspx">msxsl</a>. Также
   можно почитать <a href="HowToFB2.htm">инструкцию</a> Дмитрия Петрова по установке необходимых
   программ под Windows. <strong>Пожалуйста, обратите внимание на то, что эти XSL не гарантируют
   получение безошибчного FB2 документа. Обязательно проверяйте результаты валидатором.</strong>
  </li>
  <li>Скрипт для проверки документов на соответствие стандарту FB2.0:
      <a href="files/xmlwf.vbs">xmlwf.vbs</a>. Способ применения: из командной строки наберите
      <code>cscript //nologo &lt;путь к xmlwf.vbs&gt; &lt;путь к FictionBook.xsd&gt; &lt;проверяемый документ&gt;</code>. Для запуска небходим MSXML4 и Windows Scripting Host.</li>
      </ul>
  <br><hr noshade="1">
<h4>Макрос для экспорта документов Word в XML</h4>
Что умеет:<br>
<ul>
<li> выделение глав в соответствии со структурой документа</li>
<li> преобразование жирного и курсива в strong и emphasis</li>
<li> распознает стили "Epigraph" и "Epigraph Author" после заголовка главы и в самом начале файла</li>
<li> распознает стиль "Annotation" аналогично эпиграфам, если используется и то и другое, то "Annotaion" должен идти после всех эпиграфов</li>
<li> распознает стили "Cite" и "Cite Author" в любом месте главы.</li>
<li> распознает стихи, название стихотворения должно быть выделено стилем "Poem Title", после него должны идти абзацы стилем "Stanza", которые превращаются в &lt;stanza&gt;&lt;v&gt;&lt;/stanza&gt;, пустые строки разделяют &lt;stanza&gt;</li>
<li> превращает сноски (Footnotes,Endnotes) в &lt;a type="note"&gt;</li>
</ul>
Как пользоваться:<br>
<br>
Установить MSXML3 (входит в IE6, или доступен для скачивания отдельно на microsoft.com)<br>
Скачать готовый <a href="files/ExportXML.dot">ExportXML.dot</a>.<br>
<br>
Теперь можно открыть какой-нибудь документ, зайти в Tools-&gt;(Шаблоны и стили),
применить этот шаблон, расставить стили по вкусу и попробовать воспользоваться пунктом меню
Export as FictionBook XML...<br>
Редактирование отдельных строк в диалоге свойств FB осуществляется кнопкой F2.<br>
<br>



      <hr noshade="1">
      <div class="update">Последнее обновление: 2005/01/30 15:46</div>
      Автор: <a href="mailto:mike@haali.net">Михаил Мацнев, mike@haali.net</a>
    </div>
  </body>
</html>